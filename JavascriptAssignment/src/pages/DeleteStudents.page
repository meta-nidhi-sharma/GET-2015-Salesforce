<apex:page id="pageID" standardController="Student__c" recordSetVar="Students">
    <apex:includescript value="/soap/ajax/30.0/connection.js"></apex:includescript>
    <apex:includescript value="/soap/ajax/30.0/apex.js"></apex:includescript> 
    <apex:form id="formID">
        <apex:sectionHeader title="Delete Students"/>
        <apex:pageBlock title="Selected Student" id="pageBlock">
            <apex:pageBlockSection id="blockSection" columns="1">        
                Fetching...        
            </apex:pageBlockSection>    
            <apex:pageBlockButtons location="bottom" >
                <apex:commandButton onclick="confirmDelete();window.location='https://ap2.salesforce.com/a08'; return false;" value="Continue"/>
                <apex:commandButton onclick="window.location='https://ap2.salesforce.com/a08'; return false;" value="Cancel"/>
            </apex:pageBlockButtons>
        </apex:pageBlock>
    </apex:form>  
    <script>
    sforce.connection.sessionId = "{!$Api.Session_ID}";
    //To get id of records selected
    var idParameter = window.location.search.substring(1);
    var param=idParameter.split('=');
    var recordsRecieved=decodeURIComponent(param[1]).split('&');
    var records=recordsRecieved[0].split(',');
    //if url has selected records
    if(window.location.search.substring(1) !=""){
        for (var i = 0; i < records.length; i++) {
            records[i]="'"+records[i]+"'";
        }
        //getting student corresponding to this id
        var query = "SELECT Id,Name,class__r.Name from Student__c where Id IN (" + records + ")";
        result = sforce.connection.query(query);                                
        records = result.getArray("records");
        var student;
        //Displaying selected records in table format
        var tableModel="<table border='1' id='studentTable'><tr><th>Id</th><th>Name</th><th>Class Name</th></tr>";
        for(var i=0;i<records.length;i++) {    
            student=records[i];
            tableModel=tableModel+"<tr><td>"+student.Id+"</td><td>"+student.Name+"</td><td>"+student.Class__r.Name+"</td></tr>";            
        }        
        document.getElementById('{!$Component.pageID.formID.pageBlock.blockSection}').innerHTML=tableModel+"</table>";
    }
    function confirmDelete(){        
        var ids=[];
        //array of id of records
        for (var i = 0; i < records.length; i++) {
            student=records[i];
            ids[i]=student.Id;
        }
        //To delete selected records
        var deletionResult = sforce.connection.deleteIds([ids]);
        if (deletionResult[0].getBoolean("success")) {
            alert("students deleted");
        } else {
            alert("failed to delete student");
        }               
    }      
    </script>
</apex:page>